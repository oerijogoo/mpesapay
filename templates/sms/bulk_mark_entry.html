<!-- templates/sms/bulk_mark_entry.html -->
{% extends 'base.html' %}
{% block content %}
<div class="card shadow-lg">
    <div class="card-header bg-primary text-white">
        <h3 class="mb-0">
            <i class="fas fa-file-import me-2"></i>Bulk Mark Entry
        </h3>
    </div>

    <div class="card-body">
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}

            <div class="row mb-4">
                <div class="col-md-6">
                    <label class="form-label fw-bold">Entry Type:</label>
                    {{ form.entry_type }}
                </div>
                <div class="col-md-6">
                    <label class="form-label fw-bold">Select Paper:</label>
                    {{ form.paper }}
                </div>
            </div>

            <div class="csv-section entry-section mb-4">
                <div class="alert alert-info">
                    <i class="fas fa-info-circle me-2"></i>
                    CSV Format: admission_number,marks_obtained (one per line)
                </div>
                {{ form.csv_file }}
            </div>

            <div class="manual-section entry-section mb-4">
                <div class="alert alert-warning">
                    <i class="fas fa-exclamation-triangle me-2"></i>
                    Format: ADM-NUMBER,SCORE (e.g. SCH-001,85)
                </div>
                {{ form.marks_data }}
            </div>

            <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                <button type="submit" class="btn btn-success px-5">
                    <i class="fas fa-upload me-2"></i>Upload Marks
                </button>
                <a href="{% url 'subject_list' %}" class="btn btn-secondary px-5">
                    Cancel
                </a>
            </div>
        </form>
    </div>
</div>

<style>
.entry-section { display: none; }
.entry-section.active { display: block; }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const typeRadios = document.querySelectorAll('input[name="entry_type"]');
    const sections = {
        'csv': document.querySelector('.csv-section'),
        'manual': document.querySelector('.manual-section')
    };

    function updateDisplay() {
        const selected = document.querySelector('input[name="entry_type"]:checked').value;
        Object.values(sections).forEach(section => section.classList.remove('active'));
        sections[selected].classList.add('active');
    }

    typeRadios.forEach(radio => {
        radio.addEventListener('change', updateDisplay);
    });

    // Initial display
    updateDisplay();
});
</script>
{% endblock %}